SELECT 'In server: ' + @@SERVERNAME + N' linked server: ' + QUOTENAME(a.name) + ' has security vulnerability'
FROM sys.servers a
INNER JOIN sys.linked_logins b ON b.server_id = a.server_id
WHERE b.local_principal_id = 0 -- default security context
AND uses_self_credential = 0 -- not use own credentials
AND a.server_id <> 0 -- not local
AND (a.is_data_access_enabled = 1 or a.is_distributor = 0)